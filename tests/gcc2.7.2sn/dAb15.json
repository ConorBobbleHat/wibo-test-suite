{"compiler": "gcc2.7.2sn", "compiler_flags": "", "source_code": "/*\nInternal error:\n\nTraceback (most recent call last):\n  File \"/home/ethteck/.cache/pypoetry/virtualenvs/backend-xRJ-wtRq-py3.10/lib/python3.10/site-packages/m2c/main.py\", line 88, in run\n    typemap = build_typemap(options.c_contexts, use_cache=options.use_cache)\n  File \"/home/ethteck/.cache/pypoetry/virtualenvs/backend-xRJ-wtRq-py3.10/lib/python3.10/site-packages/m2c/c_types.py\", line 689, in build_typemap\n    return _build_typemap(tuple(source_paths), use_cache)\n  File \"/home/ethteck/.cache/pypoetry/virtualenvs/backend-xRJ-wtRq-py3.10/lib/python3.10/site-packages/m2c/c_types.py\", line 776, in _build_typemap\n    Visitor().visit(ast)\n  File \"/home/ethteck/.cache/pypoetry/virtualenvs/backend-xRJ-wtRq-py3.10/lib/python3.10/site-packages/pycparser/c_ast.py\", line 158, in visit\n    return visitor(node)\n  File \"/home/ethteck/.cache/pypoetry/virtualenvs/backend-xRJ-wtRq-py3.10/lib/python3.10/site-packages/pycparser/c_ast.py\", line 165, in generic_visit\n    self.visit(c)\n  File \"/home/ethteck/.cache/pypoetry/virtualenvs/backend-xRJ-wtRq-py3.10/lib/python3.10/site-packages/pycparser/c_ast.py\", line 158, in visit\n    return visitor(node)\n  File \"/home/ethteck/.cache/pypoetry/virtualenvs/backend-xRJ-wtRq-py3.10/lib/python3.10/site-packages/pycparser/c_ast.py\", line 165, in generic_visit\n    self.visit(c)\n  File \"/home/ethteck/.cache/pypoetry/virtualenvs/backend-xRJ-wtRq-py3.10/lib/python3.10/site-packages/pycparser/c_ast.py\", line 158, in visit\n    return visitor(node)\n  File \"/home/ethteck/.cache/pypoetry/virtualenvs/backend-xRJ-wtRq-py3.10/lib/python3.10/site-packages/pycparser/c_ast.py\", line 165, in generic_visit\n    self.visit(c)\n  File \"/home/ethteck/.cache/pypoetry/virtualenvs/backend-xRJ-wtRq-py3.10/lib/python3.10/site-packages/pycparser/c_ast.py\", line 158, in visit\n    return visitor(node)\n  File \"/home/ethteck/.cache/pypoetry/virtualenvs/backend-xRJ-wtRq-py3.10/lib/python3.10/site-packages/m2c/c_types.py\", line 755, in visit_Struct\n    parse_struct(struct, typemap)\n  File \"/home/ethteck/.cache/pypoetry/virtualenvs/backend-xRJ-wtRq-py3.10/lib/python3.10/site-packages/m2c/c_types.py\", line 438, in parse_struct\n    ret = do_parse_struct(struct, typemap)\n  File \"/home/ethteck/.cache/pypoetry/virtualenvs/backend-xRJ-wtRq-py3.10/lib/python3.10/site-packages/m2c/c_types.py\", line 478, in do_parse_struct\n    assert struct.decls, \"Empty structs are not valid C\"\nAssertionError: Empty structs are not valid C\n*/\n\nvoid func_800B1FB8(void) {\n    // ...\n}\n", "context": "typedef signed char s8;\ntypedef signed short s16;\ntypedef signed int s32;\ntypedef signed long long s64;\ntypedef unsigned char u8;\ntypedef unsigned short u16;\ntypedef unsigned int u32;\ntypedef unsigned long long u64;\n\n#define true 1\n#define false 0\n#define bool s32\n\n#define NULL 0\n\n#define STAGE_INVERTEDCASTLE_MASK 0x1F\n#define STAGE_INVERTEDCASTLE_FLAG 0x20\n#define STAGE_ST0 0x1F\n#define TOTAL_ENTITY_COUNT 256\n\n#define NA_SE_PL_COLLECT_HEART 0x67A\n\n#define PLAYER g_Entities[PLAYER_CHARACTER]\n\n#define LOW(x) (*(s32*)&(x))\n#define ABS(x) ((x) < 0 ? -(x) : (x))\n\ntypedef union {\n    s32 val;\n    struct {\n        s16 hi;\n        s16 lo;\n    } i;\n} SotnFixed32;\n\nstruct Entity;\n\ntypedef void (*PfnEntityUpdate)(struct Entity*);\n\ntypedef struct Entity {\n    /* 0x00 */ struct Unk0600B344* unk0;\n    /* 0x04 */ SotnFixed32 posX;\n    /* 0x08 */ SotnFixed32 posY;\n    /* 0x0c */ s32 velocityX;\n    /* 0x10 */ s32 velocityY;\n    /* 0x14 */ u16 hitboxOffX;\n    /* 0x16 */ s16 hitboxOffY;\n    /* 0x18 */ s16 unk18;\n    /* 0x1A */ char pad_1A[0x4];\n    /* 0x1E */ s16 rotAngle;\n    /* 0x20 */ s16 unk1A;\n    /* 0x22 */ s16 unk1C;\n    /* 0x24 */ s16 ghidra_pad_24;\n    /* 0x26 */ char pad_26[0x2];\n    /* 0x28 */ PfnEntityUpdate pfnUpdate;\n    /* 0x2c */ u16 step;\n    /* 0x2e */ u16 step_s;\n    /* 0x30 */ u16 params;\n    /* 0x32 */ u16 entityRoomIndex;\n    /* 0x34 */ u32 flags;\n    /* 0x38 */ u16 enemyId;\n    /* 0x3A */ u16 hitboxState; // hitbox state\n    /* 0x3C */ char pad_3C[2];\n    /* 0x3E */ s16 attack;\n    /* 0x40 */ s16 attackElement;\n    /* 0x42 */ s16 pad_42;\n    /* 0x44 */ u8 hitboxWidth;\n    /* 0x45 */ u8 hitboxHeight;\n    /* 0x46 */ u8 hitFlags; // 1 = took hit\n    /* 0x47 */ char pad6[0x4];\n    /* 0x4c */ u16 animFrameIdx;\n    /* 0x4e */ s16 animFrameDuration;\n    /* 0x50 */ char pad_50[0x2];\n    /* 0x52 */ s16 unk52;\n    /* 0x54 */ char pad_54[0xC];\n    /* 0x60 */ s16 primIndex;\n    /* 0x62 */ char pad_62[0x12];\n    /* 0x74 */ u16 unk74;\n    /* 0x76 */ char pad_76[0xA];\n    /* 0x80 */ s16 unk80;\n    /* 0x82 */ char pad_82[0x2];\n    /* 0x84 */ s8 unk84;\n    /* 0x85 */ s8 unk85;\n    /* 0x86 */ char pad_86[0x2];\n    /* 0x88 */ struct UnkStruct_060e8350* unk88;\n    /* 0x8C */ char pad[0x2C];\n} Entity; // size = 0xB8\n\ntypedef struct Unk0600B344 {\n    /* 0x00 */ s16 unk0;\n    /* 0x02 */ char pad_02[0x6];\n    /* 0x08 */ s16 unk8;\n    /* 0x0A */ char pad_0A[0x4];\n    /* 0x0E */ s16 zPriority;\n    /* 0x10 */ char pad_10[0x1];\n    /* 0x14 */ s32 unk14;\n    /* 0x18 */ s32 unk18;\n} Unk0600B344;\n\ntypedef struct {\n    // structure still unknown\n} Collider;\n\ntypedef struct {\n    /* 8003C7F4 */ Entity* (*func_8011AAFC)(Entity* self, u32 flags, s32 arg2);\n} GameApi; /* size=0x140 */\n\ntypedef struct {\n    s32 unk0;\n    PfnEntityUpdate func;\n} EntityEntry;\n\ntypedef struct {\n    /* 0x00 */ s32 unk0;\n    /* 0x04 */ s32 unk4;\n    /* 0x08 */ s32 unk8;\n} Unkstruct_800FD5BC;\n\n// offsets are not the same as psx\ntypedef struct {\n    u8 relics[30];\n    char pad4[0xc];\n    u8 equipHandCount[176];\n    u8 equipBodyCount[26];\n    char pad5[0x42];\n    u8 equipHandOrder[176];\n    u8 equipBodyOrder[26];\n    char pad2[0x4E];\n    s32 hp;\n    s32 hpMax;\n    s32 hearts;\n    s32 heartsMax;\n    s32 mp;\n    s32 mpMax;\n    s32 statsBase[4];\n    char pad[15];\n    s32 statsTotal[4];\n    char pad3[0x14];\n    u32 subWeapon;\n    u32 equipment[7];\n} PlayerStatus;\n\ntypedef struct {\n    /* 0x00 */ s16 attack;\n    /* 0x02 */ s16 unk2;\n    /* 0x04 */ u16 attackElement;\n    /* 0x06 */ u8 unk6;\n    /* 0x07 */ u8 sp17;\n    /* 0x08 */ u16 sp18;\n    /* 0x0A */ u8 unkA;\n    /* 0x0B */ u8 unkB;\n    /* 0x0C */ u16 sp1C;\n    /* 0x0E */ u16 sp1E;\n    /* 0x10 */ u8 sp20;\n    /* 0x11 */ u8 unk11;\n    /* 0x12 */ u16 sp22; // entity->entityRoomIndex\n} SubweaponDef;          /* size=0x14 */\n\ntypedef struct {\n    /* 0x00 */ const char* name;\n    /* 0x04 */ const char* description;\n    /* 0x08 */ s16 attack;\n    /* 0x0A */ s16 defense;\n    /* 0x0C */ u16 element;\n    /* 0x0E */ u8 itemCategory;\n    /* 0x0F */ u8 weaponId;\n    /* 0x10 */ u16 unk10;\n    /* 0x12 */ u8 playerAnim;\n    /* 0x13 */ u8 unk13;\n    /* 0x14 */ u8 unk14;\n    /* 0x15 */ u8 lockDuration;\n    /* 0x16 */ u16 chainable;\n    /* 0x18 */ u8 specialMove;\n    /* 0x19 */ u8 isConsumable;\n    /* 0x1A */ u8 enemyInvincibilityFrames;\n    /* 0x1B */ u8 unk1B;\n    /* 0x1C */ u16 unk1C;\n    /* 0x1E */ u16 unk1E;\n    /* 0x20 */ u16 unk20;\n    /* 0x22 */ u16 unk22;\n    /* 0x24 */ u16 mpUsage;\n    /* 0x26 */ u16 stunFrames;\n    /* 0x28 */ u16 hitType;\n    /* 0x2A */ u16 hitEffect;\n    /* 0x2C */ u16 icon;\n    /* 0x2E */ u16 palette;\n    /* 0x30 */ u16 criticalRate;\n    /* 0x32 */ u16 unk32;\n} Equipment; /* size=0x34 */\n\n// Defines armor, cloak and rings\ntypedef struct {\n    /* 00 */ const char* name;\n    /* 04 */ const char* description;\n    /* 08 */ u32 unk08;\n    /* 0C */ u32 unk0C;\n    /* 10 */ u32 unk10;\n    /* 14 */ u32 unk14;\n    /* 18 */ u16 icon;\n    /* 1A */ u16 palette;\n    /* 1C */ u32 unk1C;\n} Accessory; /* size=0x20 */\n\ntypedef struct {\n    /* 0x00 */ const char* name;\n    /* 0x04 */ const char* combo;\n    /* 0x08 */ const char* description;\n    /* 0x0C */ s8 mpUsage;\n    /* 0x0D */ s8 unk0D;\n    /* 0x0E */ s16 unk0E;\n    /* 0x10 */ s16 unk10;\n    /* 0x12 */ s16 unk12;\n    /* 0x14 */ s16 unk14;\n    /* 0x16 */ u16 attackElement;\n    /* 0x18 */ s16 attack;\n    /* 0x1A */ s16 unk1A;\n} SpellDef;\n\ntypedef struct {\n    /* 0x00 */ const char* name;\n    /* 0x04 */ s16 hitPoints;\n    /* 0x06 */ u16 attack;\n    /* 0x08 */ u16 attackElement;\n    /* 0x0A */ s16 defense;\n    /* 0x0C */ u16 unkC;\n    /* 0x0E */ u16 weaknesses;\n    /* 0x10 */ u16 strengths;\n    /* 0x12 */ u16 immunes;\n    /* 0x14 */ u16 absorbs;\n    /* 0x16 */ s16 level;\n    /* 0x18 */ s16 exp;\n    /* 0x1A */ s16 rareItemId;\n    /* 0x1C */ s16 uncommonItemId;\n    /* 0x1E */ u16 rareItemDropRate;\n    /* 0x20 */ u16 uncommonItemDropRate;\n    /* 0x22 */ u8 hitboxWidth;\n    /* 0x23 */ u8 hitboxHeight;\n    /* 0x24 */ s32 unk24;\n} EnemyDef; /* size=0x28 */\n\ntypedef struct Unkstruct_800A2D98 {\n    /* 0x0 */ s32 equipTypeFilter;\n    /* 0x4 */ s32 unk4;\n    /* 0x8 */ s32 unk8;\n} Unkstruct_800A2D98;\n\n// layout is different\ntypedef struct Unkstruct_800A7734 {\n    /* 0x00 */ u16 unk00;\n    /* 0x02 */ char pad_02[0x1A];\n    /* 0x1C */ u16 unk03;\n    /* 0x1E */ char pad_1E[0x2];\n} Unkstruct_800A7734; // size = 0x20\n\ntypedef struct {\n    char pad[0x3F8];\n    u32 unk0C;\n} PlayerState;\n\ntypedef enum {\n    PLAYER_CHARACTER,\n    UNK_ENTITY_1,\n    UNK_ENTITY_2,\n    UNK_ENTITY_3,\n    UNK_ENTITY_4,\n    UNK_ENTITY_5,\n    UNK_ENTITY_6,\n    UNK_ENTITY_7,\n    UNK_ENTITY_8,\n    E_WEAPON = 0x10,\n    UNK_ENTITY_13 = 0x13,\n    UNK_ENTITY_20 = 0x20,\n    UNK_ENTITY_51 = 0x51,\n    UNK_ENTITY_100 = 0x100\n} EntityTypes;\n\ntypedef enum {\n    ITEM_S_SWORD,\n    ITEM_SWORD,\n    ITEM_THROW_1,\n    ITEM_FIST,\n    ITEM_CLUB,\n    ITEM_TWOHAND,\n    ITEM_FOOD,\n    ITEM_BOMB,\n    ITEM_THROW_2,\n    ITEM_SHIELD,\n    ITEM_MEDICINE\n} ItemCategory;\n\ntypedef enum {\n    SPELL_DARK_METAMORPHOSIS,\n    SPELL_SUMMON_SPIRIT,\n    SPELL_HELLFIRE,\n    SPELL_TETRA_SPIRIT,\n    SPELL_WOLF_CHARGE,\n    SPELL_SOUL_STEAL,\n    SPELL_WING_SMASH,\n    SPELL_SWORD_BROTHERS,\n    NUM_SPELLS,\n} SpellIds;\n\ns32 SquareRoot0(s32);\ns32 func_800F4D38(s32, s32);\nvoid func_800F4994(void);\nvoid DestroyEntity(Entity* entity);\nextern int rand(void);\nu32 CheckEquipmentItemCount(u32 itemId, u32 equipType);\nvoid PlaySfx(s16 sfxId);\n\n// Not 100% sure about address, gcc seems to added the offset within\n// the struct to the base address\nextern Equipment D_800A4B04[];\n\nextern GameApi g_api;\nextern Entity g_Entities[TOTAL_ENTITY_COUNT]; // 0x060997F8\nextern EntityEntry** PfnEntityUpdates[];\nextern u16 g_StageId; // u32 in psx\nextern SpellDef g_SpellDefs[];\nextern Accessory D_800A7718[];\nextern Unkstruct_800A7734 D_800A7734[];\nextern s32 D_80137960;\nextern s32 D_80137964;\nextern s32 D_80137968;\nextern s32 D_80139828[];\nextern s32 D_8013B5E8;\nextern Unkstruct_800A2D98 D_801375CC;\nextern PlayerState g_Player;\nextern Entity* g_CurrentEntity;\nextern PlayerStatus g_Status;\nextern SubweaponDef g_Subweapons[];\ntypedef struct UnkStruct_060e8350 {\n    /* 0x00 */ s32 unk0;\n    /* 0x04 */ char pad_0[0x14];\n    /* 0x18 */ s16 unk18;\n    /* 0x1A */ char pad_1A[0x4];\n    /* 0x1E */ s16 unk1E;\n    /* 0x20 */ struct UnkStruct_060e8350* unk20;\n} UnkStruct_060e8350; // size = 0x24\n\ntypedef struct {\n    s32 unk0;\n    u8 pad[4];\n    u16 unk8;\n    u16 unk10;\n} Unk060ED26C;\n\ntypedef struct {\n    u8 pad[0x1c];\n    u32 unk28;\n} Unk2;\n\ntypedef enum {\n    E_NONE,\n    E_BREAKABLE,\n    E_EXPLOSION,\n    E_PRIZE_DROP,\n    E_NUMERIC_DAMAGE,\n    E_RED_DOOR,\n    E_INTENSE_EXPLOSION,\n    E_SOUL_STEAL_ORB,\n    E_ROOM_FOREGROUND,\n    E_STAGE_NAME_POPUP,\n    E_EQUIP_ITEM_DROP,\n    E_RELIC_ORB,\n    E_HEART_DROP,\n    E_ENEMY_BLOOD,\n    E_SAVE_GAME_POPUP,\n    E_DUMMY_0F,\n    E_DUMMY_10,\n\n    E_AXE_KNIGHT_AXE = 0x2A,\n    E_BONE_SCIMITAR_HEAD = 0x28,\n    E_FIRE = 0x38,\n    E_SLOGRA_SPEAR = 0x41,\n    E_SLOGRA_SPEAR_PROJECTILE = 0x42,\n    E_GAIBON = 0x43,\n    E_GAIBON_SMALL_FIREBALL = 0x45,\n    E_GAIBON_BIG_FIREBALL = 0x46,\n} EntityIDs;\n\ns16 Random(void);\ns32 AnimateEntity(Entity* entity, const u8 frames[], const u8 frames2[]);\nEntity* AllocEntity(Entity*, Entity*);\nvoid InitializeEntity(u16 arg0[]);\nvoid func_801C29B0(s32 sfxId); // sfx\nvoid CreateEntityFromEntity(u16 entityId, Entity* source, Entity* entity);\nvoid SetStep(u8 step);\n\nvoid func_0600AFA8(Unk0600B344*, u32);\nvoid func_0600B004(Unk0600B344*, s32);\nvoid func_0607B264(Entity*, s32);\nUnk0600B344* func_0600B344(s32, s32, s32, s32);\nvoid func_06079BB4(Entity*);\nvoid func_0607B264(Entity*, s32);\n\nextern Unk060ED26C entityRedEyeBustData;\nextern Unk2 entityRedEyeBustData2;\nextern Unk060ED26C D_060ED26C;\nextern u8 dat_060ed174[];\nextern u16 D_80180CC4[];\nextern const u8 D_80180EF0[];\nextern u16 D_80180F10[];\nextern const u8 D_80180EF8[];\nextern s32 DAT_060f4e6c[];\nextern s32 DAT_060f237c[];\nextern s32 DAT_060f2878[];", "diff_flags": [], "diff_label": "func_800B1FB8", "libraries": []}